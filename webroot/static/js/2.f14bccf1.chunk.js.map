{"version":3,"sources":["components/useDeviceMotion.js","pages/main.js","components/withSocketio.js"],"names":["useDeviceMotion","useState","permissionGranted","setPermissionGranted","moveCounter","setMoveCounter","useEffect","window","addEventListener","updateDeviceStatus","removeEventListener","lastAccVec3","prevTime","useRef","event","x","y","z","acceleration","accelerationIncludingGravity","timeNow","Date","now","timeDelta","current","deltaY","Math","abs","sign","prevMoveCounter","requestPermission","declineText","DeviceMotionEvent","then","response","alert","catch","console","error","gsap","registerPlugin","TextPlugin","gameTypeArray","Main","playerId","useParams","errorMsg","setErrorMsg","game1Result","setGame1Result","log","globalTimelineRef","socket","selectMode","mode","emit","data","toScene0","clear","timeline","repeat","repeatDelay","set","scale","autoAlpha","transformOrigin","scaleX","scaleY","rx","r","fill","add","to","rotate","duration","ease","toScene1","paused","svgCircles","Array","from","document","querySelectorAll","reverse","tl","autoRound","play","staggerFromTo","delay","toScene2","color","toScene3","staggerTo","toScene4","fromTo","toScene5","text","value","toScene6","toScene7","toScene8","toScene9","doShake","stroke","Back","easeOut","withSocketio","host","eventEmitters","emitter","ack","result","toSceneError","eventListeners","listener","callback","gameIdx","id","className","viewBox","map","_","idx","width","height","cx","cy","strokeWidth","style","position","bottom","right","background","zIndex","onPointerDown","top","left","d","transform","src","alt","href","target","io","secure","on","forEach"],"mappings":"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","file":"static/js/2.f14bccf1.chunk.js","sourcesContent":["import React, {useState, useEffect, useRef} from 'react';\r\n\r\nconst useDeviceMotion = () => {\r\n  const [permissionGranted, setPermissionGranted] = useState(false);\r\n  const [moveCounter, setMoveCounter] = useState(0);\r\n\r\n  const requestPermission = (declineText = \"Please allow the Device Motion to start the game.\\n請允許使用裝置加速計權限以進行遊戲\") => {\r\n    if (typeof(DeviceMotionEvent) === \"function\" && typeof(DeviceMotionEvent.requestPermission) === \"function\") {\r\n      DeviceMotionEvent.requestPermission().then(response => {\r\n        if (response == 'granted') {\r\n          setPermissionGranted(true);\r\n          // setGameStage(gameStatus['started']);\r\n        } else {\r\n          alert(declineText);\r\n        }\r\n      })\r\n      .catch(console.error);\r\n    } else {\r\n      setPermissionGranted(true);\r\n      // setGameStage(gameStatus['started']);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (permissionGranted) {\r\n      // alert('permissionGranted');\r\n      // seems can add both event listener at the same request\r\n      // window.addEventListener('deviceorientation', updateDeviceOrientation, false);\r\n      window.addEventListener('devicemotion', updateDeviceStatus, false);\r\n    }\r\n    return () => {\r\n      // window.removeEventListener('deviceorientation', updateDeviceOrientation, false);\r\n      window.removeEventListener('devicemotion', updateDeviceStatus, false);\r\n    }\r\n  }, [permissionGranted]);\r\n\r\n  let lastAccVec3 = [null, null, null];\r\n  let lastOriVec3 = [null, null, null];\r\n  // let lastAccDir = 0;\r\n  const threshold = 0.5;\r\n  const prevTime = useRef(0);\r\n\r\n  // const updateDeviceOrientation = (event) => {\r\n  //   lastOriVec3 = [event.alpha, event.beta, event.gamma];\r\n  //   // console.log(event.alpha, event.beta, event.gamma)\r\n  // }\r\n  const updateDeviceStatus = (event) => {\r\n    let x = 0;\r\n    let y = 0;\r\n    let z = 0;\r\n    if (event.acceleration) {\r\n      //requires a gyroscope to work.\r\n      // alert(\"Motion Acceleration: \" +  event.acceleration.x + \", \" +  event.acceleration.y + \", \" +  event.acceleration.z);\r\n      x = event.acceleration.x;\r\n      y = event.acceleration.y;\r\n      z = event.acceleration.z;\r\n    } else {\r\n      //this is for iPhone 3GS or a device with no gyroscope, and includes gravity.\r\n      // ios 13.x somehow return null in event.acceleration, so need to use this to get the acceleration\r\n      x = event.accelerationIncludingGravity.x;\r\n      y = event.accelerationIncludingGravity.y;\r\n      z = event.accelerationIncludingGravity.z;\r\n    }\r\n\r\n    // alert( x, y, z);\r\n    const timeNow = Date.now();\r\n    const timeDelta = timeNow - prevTime.current;\r\n    // event.interval is differnet scale in ios(0.016) and android (16)\r\n    // const timeDelta = event.interval;\r\n    // alert(`${x}, ${y}, ${z}`);\r\n    \r\n    let deltaX = Math.abs(x - lastAccVec3[0]);\r\n    let deltaY = Math.abs(y - lastAccVec3[1]);\r\n    let deltaZ = Math.abs(z - lastAccVec3[2]);\r\n\r\n    if (Math.sign(lastAccVec3[1]) !== Math.sign(y)) {\r\n      prevTime.current = timeNow;\r\n      lastAccVec3 = [x, y, z];\r\n    }\r\n    // let currentAccDir = Math.sign(y - lastAccVec3[1]);\r\n    if (deltaY / timeDelta > threshold) {\r\n      setMoveCounter((prevMoveCounter) => {\r\n        return prevMoveCounter + 1;\r\n      })\r\n    } \r\n    // else {\r\n    //   setMoveCounter((prevMoveCounter) => {\r\n    //     return Math.max(0, prevMoveCounter - 1);\r\n    //   })\r\n    // }\r\n  }\r\n  \r\n  return [{\r\n    // direction, \r\n    // speed, \r\n    // angle,\r\n    moveCounter,\r\n    permissionGranted\r\n  }, {\r\n    requestPermission,\r\n    setPermissionGranted,\r\n    setMoveCounter\r\n  }];\r\n}\r\n\r\nexport default useDeviceMotion;","import React, { useEffect, useRef, useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\n\r\nimport gsap from 'gsap';\r\nimport {Back, TextPlugin} from 'gsap/all';\r\n\r\nimport useDeviceMotion from 'components/useDeviceMotion';\r\nimport withSocketio from 'components/withSocketio';\r\n\r\nimport './main.css';\r\ngsap.registerPlugin(TextPlugin);\r\n\r\nconst scenes = {\r\n  // 0:  'Start',\r\n  0:  'Idle',\r\n  1:  'WaitForPlayer',\r\n  2:  'ModePick',\r\n  3:  'WaitForPlayerMode',\r\n  4:  'ModeResult',\r\n  5:  'GameOneReady',\r\n  6:  'GameOnePlay',\r\n  7:  'GameoneResult',\r\n  8:  'GameTwoReady',\r\n  9:  'GameTwoPlay',\r\n  10: 'GameTwoResult',\r\n}\r\nconst gameTypeArray = [\r\n  'Day',\r\n  'Night'\r\n];\r\nconst Main = () => {\r\n  const params = useParams();\r\n  const playerId = params['playerId'];\r\n  const [{moveCounter, permissionGranted},{requestPermission, setMoveCounter}] = useDeviceMotion();\r\n  const [errorMsg, setErrorMsg] = useState(\"\");\r\n  const [game1Result, setGame1Result] = useState(\"\");\r\n\r\n  console.log('playerId: ', playerId);\r\n  const globalTimelineRef = useRef(null);\r\n  const socket = useRef(null);\r\n\r\n  const selectMode = (mode) => {\r\n    if (socket.current) {\r\n      socket.current.emit('selectGame', {\r\n        data: mode\r\n      })\r\n    }\r\n  }\r\n  const joinGame = () => {\r\n    requestPermission();\r\n  }\r\n  const toScene0 = () => {\r\n    if (globalTimelineRef.current)\r\n      globalTimelineRef.current.clear();\r\n    globalTimelineRef.current = gsap.timeline({\r\n      repeat: -1,\r\n      repeatDelay: 3\r\n      // yoyo: true\r\n    })\r\n    gsap.set('#mainCircle', {\r\n      scale: 1,\r\n      autoAlpha: 1,\r\n      transformOrigin: \"center\"\r\n    })\r\n    gsap.set('.svgCircle', {\r\n      scaleX: 2,\r\n      scaleY: 1,\r\n      rx: 0,\r\n      transformOrigin: \"center\"\r\n    })\r\n    gsap.set('#circle1', {\r\n      autoAlpha: 0,\r\n      r: 4\r\n    })\r\n    gsap.set('.scene', {\r\n      autoAlpha: 0\r\n    })\r\n    gsap.set('.scene.scene0', {\r\n      autoAlpha: 1\r\n    })\r\n    gsap.set('#circle1', {\r\n      r: 4\r\n    })\r\n    gsap.set('#circleBackground', {\r\n      r: 0,\r\n      fill: 'none'\r\n    })\r\n    \r\n    globalTimelineRef.current.add(\r\n      gsap.to('.scene0 .joinGameButton', {\r\n        rotate: -5,\r\n        duration: 0.1,\r\n        ease: \"elastic.out(1, 0.75)\"\r\n      })\r\n    )\r\n    globalTimelineRef.current.add(\r\n      gsap.to('.scene0 .joinGameButton', {\r\n        rotate: 0,\r\n        duration: 1,\r\n        ease: \"elastic.out(2, 0.2)\"\r\n      })\r\n    )\r\n  }\r\n  const toScene1 = () => {\r\n    if (globalTimelineRef.current)\r\n      globalTimelineRef.current.clear();\r\n    globalTimelineRef.current = gsap.timeline({\r\n      repeat: -1,\r\n      paused: true,\r\n      // yoyo: true\r\n    });\r\n    const svgCircles = Array.from(document.querySelectorAll('.svgCircle')).reverse();\r\n    const tl = gsap.timeline();\r\n    tl.add([\r\n      gsap.to(svgCircles, {\r\n        scaleX: 1,\r\n        scaleY: 1,\r\n        rx: 100,\r\n        autoRound: false,\r\n        duration: 0.5\r\n      }),\r\n      gsap.to('.scene.scene0', {\r\n        autoAlpha: 0\r\n      })\r\n    ]);\r\n    tl.add([\r\n      gsap.set('#circle1', {\r\n        autoAlpha: 0\r\n      }),\r\n      gsap.set('.scene.scene1', {\r\n        autoAlpha: 1\r\n      }),\r\n    ]);\r\n    tl.add(() => {globalTimelineRef.current.play()});\r\n    globalTimelineRef.current.add([\r\n      gsap.timeline().staggerFromTo(svgCircles, 0.6, {\r\n        scale: 1,\r\n        autoRound: false,\r\n      }, {\r\n        scale: 1.1,\r\n        autoRound: false,\r\n        ease: \"power1.out\"\r\n      }, 0.3),\r\n      gsap.timeline().staggerFromTo(svgCircles, 0.6, {\r\n        scale: 1.1,\r\n        autoRound: false,\r\n      }, {\r\n        scale: 1,\r\n        autoRound: false,\r\n        delay: 0.6,\r\n        ease: \"power1.in\"\r\n      }, 0.3)\r\n    ])\r\n  }\r\n  const toScene2 = () => {\r\n    if (globalTimelineRef.current)\r\n      globalTimelineRef.current.clear();\r\n    const tl = gsap.timeline();\r\n    tl.add([\r\n      gsap.set('.scene2 .option', {\r\n        scale: 0,\r\n        color: 'transparent'\r\n      })\r\n    ])\r\n    tl.add(\r\n      gsap.to('#mainCircle', {\r\n        scale: 4,\r\n        transformOrigin: \"center\",\r\n        duration: 0.5\r\n      })\r\n    )\r\n    tl.add(\r\n      gsap.to('.scene1', {\r\n        autoAlpha: 0\r\n      })\r\n    )\r\n    tl.add(\r\n      gsap.to('.scene2', {\r\n        autoAlpha: 1\r\n      })\r\n    )\r\n    tl.add([\r\n      gsap.to('.scene2 .option1', {\r\n        scale: 1\r\n      }),\r\n      gsap.to('.scene2 .option2', {\r\n        scale: 1\r\n      })\r\n    ])\r\n    tl.add([\r\n      gsap.to('.scene2 .option1', {\r\n        color: '#000000'\r\n      }),\r\n      gsap.to('.scene2 .option2', {\r\n        color: '#FFFFFF'\r\n      })\r\n    ])\r\n  }\r\n  const toScene3 = () => {\r\n    if (globalTimelineRef.current)\r\n      globalTimelineRef.current.clear();\r\n    globalTimelineRef.current = gsap.timeline({\r\n      repeat: -1,\r\n      paused: true\r\n    });\r\n    const tl = gsap.timeline();\r\n    gsap.set('#circle1', {\r\n      r: 4,\r\n      autoAlpha: 0\r\n    })\r\n    gsap.set('.svgCircle', {\r\n      autoAlpha: 0\r\n    })\r\n    gsap.set('#mainCircle', {\r\n      scale: 1\r\n    })\r\n    tl.add(\r\n      gsap.to('.scene2', {\r\n        autoAlpha: 0\r\n      })\r\n    )\r\n    tl.add([\r\n      gsap.to('.scene3', {\r\n        autoAlpha: 1\r\n      })\r\n    ])\r\n    const svgCircles = Array.from(document.querySelectorAll('.svgCircle')).reverse();\r\n    tl.add(() => {globalTimelineRef.current.play()});\r\n    tl.add([\r\n      gsap.timeline().staggerTo(svgCircles, 0.6, {\r\n        autoAlpha: 1\r\n      }, 0.3),\r\n      // /\r\n    ])\r\n    globalTimelineRef.current.add([\r\n      gsap.timeline().staggerFromTo(svgCircles, 0.6, {\r\n        scale: 1,\r\n        autoRound: false,\r\n      }, {\r\n        scale: 1.1,\r\n        autoRound: false,\r\n        ease: \"power1.out\"\r\n      }, 0.3),\r\n      gsap.timeline().staggerFromTo(svgCircles, 0.6, {\r\n        scale: 1.1,\r\n        autoRound: false,\r\n      }, {\r\n        scale: 1,\r\n        autoRound: false,\r\n        delay: 0.6,\r\n        ease: \"power1.in\"\r\n      }, 0.3)\r\n    ])\r\n  }\r\n  const toScene4 = () => {\r\n    if (globalTimelineRef.current)\r\n      globalTimelineRef.current.clear();\r\n    \r\n    const tl = gsap.timeline();\r\n    gsap.set('#circle1', {\r\n      r: 4,\r\n      autoAlpha: 0\r\n    })\r\n    gsap.set('#circle1', {\r\n      r: game1Result === \"Day\"? 3.5: 4.2,\r\n      autoAlpha: 0\r\n    })\r\n    gsap.to('#mainCircle', {\r\n      scale: 2\r\n    })\r\n    tl.add(\r\n      gsap.to('.scene3', {\r\n        autoAlpha: 0\r\n      })\r\n    )\r\n    tl.add([\r\n      gsap.fromTo('.scene4', {\r\n        autoAlpha: 0,\r\n        color: 'transparent'\r\n      }, {\r\n        autoAlpha: 1,\r\n        color: game1Result === \"Day\"? '#000000': '#FFFFFF'\r\n      }),\r\n      gsap.fromTo('#circleBackground', {\r\n        r: 0,\r\n        fill: game1Result === \"Day\"? '#FFFFFF': '#000000'\r\n      }, {\r\n        autoRound: false,\r\n        r: 2.5\r\n      })\r\n    ])\r\n    \r\n  }\r\n  const toScene5 = () => {\r\n    if (globalTimelineRef.current)\r\n      globalTimelineRef.current.clear();\r\n    const tl = gsap.timeline();\r\n    tl.add(\r\n      gsap.to('.scene4', {\r\n        autoAlpha: 0,\r\n      })\r\n    )\r\n    tl.add(\r\n      gsap.to('.scene5', {\r\n        autoAlpha: 1,\r\n      })\r\n    )\r\n    gsap.set('.scene5 .centerText', {\r\n      color: game1Result === \"Day\"? '#000000': '#FFFFFF'\r\n    })\r\n    tl.add(\r\n      gsap.fromTo('.scene5 .centerText', {\r\n        text: {\r\n          value: 3\r\n        },\r\n        y: '-50%',\r\n        scale: 0,\r\n        autoAlpha: 0\r\n      }, {\r\n        y: '-50%',\r\n        scale: 1,\r\n        autoAlpha: 1,\r\n        duration: 1\r\n      })\r\n    )\r\n    tl.add(\r\n      gsap.fromTo('.scene5 .centerText', {\r\n        text: {\r\n          value: 2\r\n        },\r\n        y: '-50%',\r\n        scale: 0,\r\n        autoAlpha: 0\r\n      }, {\r\n        y: '-50%',\r\n        scale: 1,\r\n        autoAlpha: 1,\r\n        duration: 1\r\n      })\r\n    )\r\n    tl.add(\r\n      gsap.fromTo('.scene5 .centerText', {\r\n        text: {\r\n          value: 1\r\n        },\r\n        y: '-50%',\r\n        scale: 0,\r\n        autoAlpha: 0\r\n      }, {\r\n        y: '-50%',\r\n        scale: 1,\r\n        autoAlpha: 1,\r\n        duration: 1\r\n      })\r\n    )\r\n  }\r\n  const toScene6 = () => {\r\n    const tl = gsap.timeline();\r\n    gsap.set('.scene6 .centerText', {\r\n      color: game1Result === \"Day\"? '#000000': '#FFFFFF'\r\n    })\r\n    tl.add(\r\n      gsap.to('.scene5', {\r\n        autoAlpha: 0,\r\n      })\r\n    )\r\n    tl.add(\r\n      gsap.to('.scene6', {\r\n        autoAlpha: 1,\r\n      })\r\n    )\r\n  }\r\n  const toScene7 = () => {\r\n    const tl = gsap.timeline();\r\n    tl.add(\r\n      gsap.to('.scene6', {\r\n        autoAlpha: 0,\r\n      })\r\n    )\r\n    tl.add(\r\n      gsap.to('.scene7', {\r\n        autoAlpha: 1,\r\n      })\r\n    )\r\n    gsap.set('.scene7 .centerText', {\r\n      color: game1Result === \"Day\"? '#000000': '#FFFFFF'\r\n    })\r\n    // tl.add(\r\n    //   gsap.fromTo('.scene7 .centerText', {\r\n    //     text: {\r\n    //       value: 3\r\n    //     },\r\n    //     y: '-50%',\r\n    //     scale: 0,\r\n    //     autoAlpha: 0\r\n    //   }, {\r\n    //     y: '-50%',\r\n    //     scale: 1,\r\n    //     autoAlpha: 1,\r\n    //     duration: 1\r\n    //   })\r\n    // )\r\n    // tl.add(\r\n    //   gsap.fromTo('.scene7 .centerText', {\r\n    //     text: {\r\n    //       value: 2\r\n    //     },\r\n    //     y: '-50%',\r\n    //     scale: 0,\r\n    //     autoAlpha: 0\r\n    //   }, {\r\n    //     y: '-50%',\r\n    //     scale: 1,\r\n    //     autoAlpha: 1,\r\n    //     duration: 1\r\n    //   })\r\n    // )\r\n    // tl.add(\r\n    //   gsap.fromTo('.scene7 .centerText', {\r\n    //     text: {\r\n    //       value: 1\r\n    //     },\r\n    //     y: '-50%',\r\n    //     scale: 0,\r\n    //     autoAlpha: 0\r\n    //   }, {\r\n    //     y: '-50%',\r\n    //     scale: 1,\r\n    //     autoAlpha: 1,\r\n    //     duration: 1\r\n    //   })\r\n    // )\r\n  }\r\n  const toScene8 = () => {\r\n    const tl = gsap.timeline();\r\n    gsap.set('.scene8 .centerText', {\r\n      color: game1Result === \"Day\"? '#000000': '#FFFFFF'\r\n    })\r\n    tl.add(\r\n      gsap.to('.scene7', {\r\n        autoAlpha: 0,\r\n      })\r\n    )\r\n    tl.add(\r\n      gsap.to('.scene8', {\r\n        autoAlpha: 1,\r\n      })\r\n    )\r\n  }\r\n  const toScene9 = () => {\r\n    const tl = gsap.timeline();\r\n    tl.add([\r\n      gsap.to('#mainCircle', {\r\n        scale: 4,\r\n        autoAlpha: 0\r\n      }),\r\n      gsap.to('.scene8', {\r\n        autoAlpha: 0,\r\n      })\r\n    ])\r\n    tl.add(\r\n      gsap.to('.scene9', {\r\n        autoAlpha: 1,\r\n      })\r\n    )\r\n  }\r\n  const toSceneError = () => {\r\n    const tl = gsap.timeline();\r\n    tl.add(\r\n      gsap.to('.scene', {\r\n        autoAlpha: 0,\r\n      })\r\n    )\r\n    tl.add(\r\n      gsap.to('.sceneError', {\r\n        autoAlpha: 1,\r\n      })\r\n    )\r\n  }\r\n  const doShake = () => {\r\n    if (socket.current)\r\n      socket.current.emit('shake');\r\n    const tl = gsap.timeline();\r\n    gsap.set('.shakeEffect g', {\r\n      stroke: game1Result === \"Day\"? '#000000': '#FFFFFF'\r\n    })\r\n    tl.add(\r\n      gsap.to('.mobileIcon', {\r\n        rotate: 10,\r\n        ease: Back.easeOut,\r\n        duration: 0.1\r\n      })\r\n    )\r\n    tl.add([\r\n      gsap.to('.shakeEffect', {\r\n        autoAlpha: 1,\r\n        duration: 0.25\r\n      }),\r\n      gsap.to('.mobileIcon', {\r\n        rotate: -15,\r\n        duration: 0.25\r\n      })\r\n    ])\r\n    tl.add([\r\n      gsap.to('.shakeEffect', {\r\n        autoAlpha: 0,\r\n        duration: 0.15\r\n      }),\r\n      gsap.to('.mobileIcon', {\r\n        rotate: 0,\r\n        ease: Back.easeOut,\r\n        duration: 0.15\r\n      })\r\n    ])\r\n  }\r\n  useEffect(() => {\r\n    toScene0();\r\n    // disable double tap zoom\r\n    document.addEventListener(\"click\", event => {});\r\n  }, []);\r\n  useEffect(() => {\r\n    if (permissionGranted) {\r\n      // socket.current = io('ws://10.0.1.40:3005');\r\n      socket.current = withSocketio({\r\n        host: '10.0.1.40:3003',\r\n        eventEmitters: [\r\n          {\r\n            emitter: 'joinRoom',\r\n            data: {\r\n              playerId: playerId\r\n            },\r\n            ack: (result) => {\r\n              console.log('joinRoomAck', result);\r\n              if (result['data'] !== \"joined\") {\r\n                setErrorMsg(result['data']);\r\n                toSceneError();\r\n              }\r\n              //  else {\r\n              //   // wait gameStage event do stage change\r\n              //   toScene1();\r\n              // }\r\n              //   setGameStage(gameStatus.offline);\r\n              //   setAlertText(result['data']);\r\n              // } else {\r\n              //   setPlayerColorCode(\r\n              //     playerColorCodeOfIdx[result['index']]\r\n              //   );\r\n              // }\r\n            }\r\n          }\r\n        ],\r\n        eventListeners: [\r\n          {\r\n            listener: 'gameStage',\r\n            callback: (data) => {\r\n              console.log('gameStage', data);\r\n              const stageId = data['data'];\r\n              switch (stageId) {\r\n                case 0:\r\n                  toScene0();\r\n                  break;\r\n                case 1:\r\n                  toScene1();\r\n                  break;\r\n                case 2:\r\n                  toScene2();\r\n                  break;\r\n                case 3:\r\n                  toScene3();\r\n                  break;\r\n                case 4:\r\n                  toScene4();\r\n                  break;\r\n                case 5:\r\n                  toScene5();\r\n                  break;\r\n                case 6:\r\n                  toScene6();\r\n                  break;\r\n                case 7:\r\n                  toScene7();\r\n                  break;\r\n                case 8:\r\n                  // toScene8();\r\n                  break;\r\n                case 9:\r\n                  toScene8();\r\n                  break;\r\n                case 10:\r\n                  toScene9();\r\n                  //   toScene10();\r\n                  break;\r\n              }\r\n              // setGameStage(stageId);\r\n              // if (stageId === gameStatus.selecting) {\r\n              //   setGameSelected(0);\r\n              // } else \r\n              // if (stageId === gameStatus.result) {\r\n              //   socket.current.disconnect();\r\n              // }\r\n            }\r\n          },\r\n          {\r\n            listener: 'gameResult',\r\n            callback: (data) => {\r\n              console.log('gameResult', data);\r\n              // const score = data['data'];\r\n              // setScore(Math.round(score));\r\n            }\r\n          },\r\n          {\r\n            listener: 'playersInfo',\r\n            callback: (data) => {\r\n              console.log('playersInfo', data);\r\n              // const players = data['data'];\r\n              // players.forEach(player => {\r\n              //   if (player['playerId'] === playerId['playerId']) {\r\n              //     setIsJoined(player['joined']);\r\n              //   }\r\n              // });\r\n            }\r\n          },\r\n          {\r\n            listener: 'OnPlayerSelectMode',\r\n            callback: (data) => {\r\n              console.log('OnPlayerSelectMode', data);\r\n              const gameIdx = data['data'];\r\n              setGame1Result(gameTypeArray[gameIdx]);\r\n            }\r\n          },\r\n          {\r\n            listener: 'gameSelected',\r\n            callback: (data) => {\r\n              console.log('gameSelected', data);\r\n              // const gameId = data['data'];\r\n              // setGameSelected(gameId);\r\n              // gameSelected.current = gameId;\r\n            }\r\n          },\r\n        ]\r\n      })\r\n      toScene1();\r\n    }\r\n  }, [permissionGranted])\r\n  useEffect(() => {\r\n    doShake();\r\n  }, [moveCounter])\r\n  return <div id=\"gameMain\">\r\n    <div className=\"background\">\r\n      <svg viewBox=\"0 0 10 10\">\r\n        <g id=\"mainCircle\">\r\n          {new Array(11).fill(0).map((_, idx) => {\r\n            return <rect id={`circle${idx+2}`} className=\"svgCircle\" rx=\"100\" key={idx} x={5 - (27 - idx * 2) / 2} y={5 - (27 - idx * 2) / 2} width={27 - idx * 2} height={27 - idx * 2} fill={idx % 2? '#000000': '#FFFFFF'} />\r\n          })}\r\n          <circle id=\"circle1\" cx=\"5\" cy=\"5\" r=\"4\"\r\n            fill=\"none\"\r\n            stroke=\"#000000\"\r\n            strokeWidth=\"1\">\r\n          </circle>\r\n          <circle id=\"circleBackground\" cx=\"5\" cy=\"5\" r=\"0\" fill=\"none\" />\r\n        </g>\r\n      </svg>\r\n    </div>\r\n    <div className=\"reset\" style={{position:'absolute',bottom:0,right:0,background:'#FFF',zIndex:99}} onPointerDown={toScene0}>reset</div>\r\n    <div className=\"debug\" style={{position:'absolute',top:0,left:0,background:'#FFF',zIndex:99}} onPointerDown={()=>setMoveCounter(0)}>{moveCounter}</div>\r\n    <div className=\"scene scene0\">\r\n      <div className=\"joinGameButton\" onPointerDown={joinGame}>Join Game</div>\r\n    </div>\r\n    <div className=\"scene scene1\" onPointerDown={toScene2}>\r\n      <div className=\"centerText\">Wait for other players ...</div>\r\n    </div>\r\n    <div className=\"scene scene2\">\r\n      <div className=\"centerText\">Which look would you like to do?</div>\r\n      <div className=\"option option1\" onPointerDown={() => {\r\n        // setGame1Result(\"Day\");\r\n        selectMode(0);\r\n        toScene3();\r\n      }}>Day</div>\r\n      <div className=\"option option2\" onPointerDown={() => {\r\n        // setGame1Result(\"Night\");\r\n        selectMode(1);\r\n        toScene3();\r\n      }}>Night</div>\r\n    </div>\r\n    <div className=\"scene scene3\" onPointerDown={toScene4}>\r\n      <div className=\"centerText\">Loading...</div>\r\n    </div>\r\n    <div className=\"scene scene4\" onPointerDown={toScene5}>\r\n      <div className=\"centerText\">\r\n        <div className=\"resultTitle\">The look we are doing is...</div>\r\n        <div className=\"resultText\">{game1Result}!</div>\r\n      </div>\r\n    </div>\r\n    <div className=\"scene scene5\" onPointerDown={toScene6}>\r\n      <div className=\"centerText\"></div>\r\n    </div>\r\n    <div className=\"scene scene6\">\r\n      <div className=\"centerText\">\r\n        <svg viewBox=\"0 0 35 23\" className=\"shakeEffect shakeEffect1\">\r\n          <g stroke=\"#FFF\" fill=\"none\" strokeWidth=\"3\">\r\n            <path d=\"M153.28 463.88l1.277-.34c7.393-1.973 14.995 2.385 17.029 9.762h0\" transform=\"translate(-141 -459) rotate(-177 162.433 466.64)\"/>\r\n            <path d=\"M142.736 467.692l2.32-.619c13.321-3.55 27.013 4.3 30.68 17.589h0\" transform=\"translate(-141 -459) rotate(-177 159.236 472.662)\"/>\r\n          </g>\r\n        </svg>\r\n        <svg viewBox=\"0 0 35 23\" className=\"shakeEffect shakeEffect2\">\r\n          <g stroke=\"#FFF\" fill=\"none\" strokeWidth=\"3\">\r\n            <path d=\"M153.28 463.88l1.277-.34c7.393-1.973 14.995 2.385 17.029 9.762h0\" transform=\"translate(-141 -459) rotate(-177 162.433 466.64)\"/>\r\n            <path d=\"M142.736 467.692l2.32-.619c13.321-3.55 27.013 4.3 30.68 17.589h0\" transform=\"translate(-141 -459) rotate(-177 159.236 472.662)\"/>\r\n          </g>\r\n        </svg>\r\n        <svg className=\"mobileIcon\" viewBox=\"0 0 90 157\" onPointerDown={doShake}>\r\n          <rect width=\"90\" height=\"157\" fill=\"#FFF\" rx=\"2\" stroke=\"#000\"/>\r\n          <rect width=\"81\" height=\"121\" x=\"5\" y=\"14\" fill=\"#000\" rx=\"2\"/>\r\n          <circle cx=\"45\" cy=\"146\" r=\"6.5\" stroke=\"#000\"/>\r\n        </svg>\r\n        <div onPointerDown={toScene7}>Shake!</div>\r\n      </div>\r\n    </div>\r\n    <div className=\"scene scene7\" onPointerDown={toScene8}>\r\n      <div className=\"centerText\">Waiting...</div>\r\n    </div>\r\n    <div className=\"scene scene8\">\r\n      <div className=\"centerText\">\r\n        <svg viewBox=\"0 0 35 23\" className=\"shakeEffect shakeEffect1\">\r\n          <g stroke=\"#FFF\" fill=\"none\" strokeWidth=\"3\">\r\n            <path d=\"M153.28 463.88l1.277-.34c7.393-1.973 14.995 2.385 17.029 9.762h0\" transform=\"translate(-141 -459) rotate(-177 162.433 466.64)\"/>\r\n            <path d=\"M142.736 467.692l2.32-.619c13.321-3.55 27.013 4.3 30.68 17.589h0\" transform=\"translate(-141 -459) rotate(-177 159.236 472.662)\"/>\r\n          </g>\r\n        </svg>\r\n        <svg viewBox=\"0 0 35 23\" className=\"shakeEffect shakeEffect2\">\r\n          <g stroke=\"#FFF\" fill=\"none\" strokeWidth=\"3\">\r\n            <path d=\"M153.28 463.88l1.277-.34c7.393-1.973 14.995 2.385 17.029 9.762h0\" transform=\"translate(-141 -459) rotate(-177 162.433 466.64)\"/>\r\n            <path d=\"M142.736 467.692l2.32-.619c13.321-3.55 27.013 4.3 30.68 17.589h0\" transform=\"translate(-141 -459) rotate(-177 159.236 472.662)\"/>\r\n          </g>\r\n        </svg>\r\n        <svg className=\"mobileIcon\" viewBox=\"0 0 90 157\" onPointerDown={doShake}>\r\n          <rect width=\"90\" height=\"157\" fill=\"#FFF\" rx=\"2\" stroke=\"#000\"/>\r\n          <rect width=\"81\" height=\"121\" x=\"5\" y=\"14\" fill=\"#000\" rx=\"2\"/>\r\n          <circle cx=\"45\" cy=\"146\" r=\"6.5\" stroke=\"#000\"/>\r\n        </svg>\r\n        <div onPointerDown={toScene9}>Shake!</div>\r\n      </div>\r\n    </div>\r\n    <div className=\"scene scene9\">\r\n      <div className=\"centerText\">\r\n        <img id=\"logo\" src=\"./media/logo.svg\" alt=\"SEPHORA\" />\r\n        <div className=\"coupon\">\r\n          <img src=\"./media/coupon.jpg\" alt=\"coupon\"/>\r\n        </div>\r\n        <div className=\"disclaimer\">\r\n          Offer is valid once per member during Jan 6 - 31, 2021 at in Sephora Hong Kong K-11 Art Mall store. Offer is not valid with other discounts and promotion, gift cards, services, charitable items or any other exclusions mentioned in-store, on <a href=\"https://sephora.hk\" target=\"_blank\">sephora.hk</a> and/or and Sephora Hong Kong mobile app.\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div className=\"scene sceneError\">\r\n      <div className=\"centerText\">\r\n        {errorMsg}\r\n      </div>\r\n    </div>\r\n  </div>\r\n}\r\n\r\nexport default Main;","import io from 'socket.io-client';\r\n\r\nconst withSocketio = ({\r\n  host,\r\n  eventListeners,\r\n  eventEmitters\r\n}) => {\r\n  const socket = io(host, {secure: false});\r\n  \r\n  // console.log(socket);\r\n  \r\n  socket.on('connect', () => {\r\n    console.log('connected !');\r\n    // socket.emit('joinRoom', props.match.match.params.userId);\r\n    // wait join result msg from server\r\n    eventEmitters.forEach(event => {\r\n      const ack = (typeof(event.ack) === \"function\"? event.ack: null);\r\n      socket.emit(event.emitter, event.data, ack);\r\n    });\r\n  });\r\n\r\n  eventListeners.forEach(event => {\r\n    socket.on(event.listener, event.callback);\r\n  });\r\n\r\n  return socket;\r\n}\r\n\r\nexport default withSocketio;"],"sourceRoot":""}