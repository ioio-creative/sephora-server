(this["webpackJsonpsephora-shakeshakegame"]=this["webpackJsonpsephora-shakeshakegame"]||[]).push([[2,8],{20:function(e,t,a){"use strict";a.r(t);var c,n=a(64),o=a(92),r=a(3),s=a(0),i=a(1),l=a(93),d=a(95),u=a(36),h=function(){var e=Object(s.useState)(!1),t=Object(n.a)(e,2),a=t[0],c=t[1],o=Object(s.useState)(0),r=Object(n.a)(o,2),i=r[0],l=r[1];Object(s.useEffect)((function(){return a&&window.addEventListener("devicemotion",h,!1),function(){window.removeEventListener("devicemotion",h,!1)}}),[a]);var d=[null,null,null],u=Object(s.useRef)(0),h=function(e){var t=0,a=0,c=0;e.acceleration?(t=e.acceleration.x,a=e.acceleration.y,c=e.acceleration.z):(t=e.accelerationIncludingGravity.x,a=e.accelerationIncludingGravity.y,c=e.accelerationIncludingGravity.z);var n=Date.now(),o=n-u.current,r=(Math.abs(t-d[0]),Math.abs(a-d[1]));Math.abs(c-d[2]);Math.sign(d[1])!==Math.sign(a)&&(u.current=n,d=[t,a,c]),r/o>.5&&l((function(e){return e+1}))};return[{moveCounter:i,permissionGranted:a},{requestPermission:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Please allow the Device Motion to start the game.\n\u8acb\u5141\u8a31\u4f7f\u7528\u88dd\u7f6e\u52a0\u901f\u8a08\u6b0a\u9650\u4ee5\u9032\u884c\u904a\u6232";"function"===typeof DeviceMotionEvent&&"function"===typeof DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then((function(t){"granted"==t?c(!0):alert(e)})).catch(console.error):c(!0)},setPermissionGranted:c,setMoveCounter:l}]},j=a(43);a(35);l.a.registerPlugin(d.a);c={0:"Start"},Object(o.a)(c,"0","Idle"),Object(o.a)(c,1,"WaitForPlayer"),Object(o.a)(c,2,"ModePick"),Object(o.a)(c,3,"WaitForPlayerMode"),Object(o.a)(c,4,"ModeResult"),Object(o.a)(c,5,"GameOneReady"),Object(o.a)(c,6,"GameOnePlay"),Object(o.a)(c,7,"GameoneResult"),Object(o.a)(c,8,"GameTwoReady"),Object(o.a)(c,9,"GameTwoPlay"),Object(o.a)(c,10,"GameTwoResult"),t.default=function(){var e=Object(i.g)().playerId,t=h(),a=Object(n.a)(t,2),c=a[0],o=c.moveCounter,d=c.permissionGranted,m=a[1],f=m.requestPermission,b=m.setMoveCounter,x=Object(s.useState)(""),v=Object(n.a)(x,2),p=v[0],O=v[1],g=Object(s.useState)(""),F=Object(n.a)(g,2),k=F[0],y=F[1];console.log("playerId: ",e);var A=Object(s.useRef)(null),w=Object(s.useRef)(null),N=function(e){w.current&&w.current.emit("selectGame",{data:e})},T=function(){A.current&&A.current.clear(),A.current=l.a.timeline({repeat:-1,repeatDelay:3}),l.a.set("#mainCircle",{scale:1,autoAlpha:1,transformOrigin:"center"}),l.a.set(".svgCircle",{scaleX:2,scaleY:1,rx:0,transformOrigin:"center"}),l.a.set("#circle1",{autoAlpha:0,r:4}),l.a.set(".scene",{autoAlpha:0}),l.a.set(".scene.scene0",{autoAlpha:1}),l.a.set("#circle1",{r:4}),l.a.set("#circleBackground",{r:0,fill:"none"}),A.current.add(l.a.to(".scene0 .joinGameButton",{rotate:-5,duration:.1,ease:"elastic.out(1, 0.75)"})),A.current.add(l.a.to(".scene0 .joinGameButton",{rotate:0,duration:1,ease:"elastic.out(2, 0.2)"}))},D=function(){A.current&&A.current.clear(),A.current=l.a.timeline({repeat:-1,paused:!0});var e=Array.from(document.querySelectorAll(".svgCircle")).reverse(),t=l.a.timeline();t.add([l.a.to(e,{scaleX:1,scaleY:1,rx:100,autoRound:!1,duration:.5}),l.a.to(".scene.scene0",{autoAlpha:0})]),t.add([l.a.set("#circle1",{autoAlpha:0}),l.a.set(".scene.scene1",{autoAlpha:1})]),t.add((function(){A.current.play()})),A.current.add([l.a.timeline().staggerFromTo(e,.6,{scale:1,autoRound:!1},{scale:1.1,autoRound:!1,ease:"power1.out"},.3),l.a.timeline().staggerFromTo(e,.6,{scale:1.1,autoRound:!1},{scale:1,autoRound:!1,delay:.6,ease:"power1.in"},.3)])},P=function(){A.current&&A.current.clear();var e=l.a.timeline();e.add([l.a.set(".scene2 .option",{scale:0,color:"transparent"})]),e.add(l.a.to("#mainCircle",{scale:4,transformOrigin:"center",duration:.5})),e.add(l.a.to(".scene1",{autoAlpha:0})),e.add(l.a.to(".scene2",{autoAlpha:1})),e.add([l.a.to(".scene2 .option1",{scale:1}),l.a.to(".scene2 .option2",{scale:1})]),e.add([l.a.to(".scene2 .option1",{color:"#000000"}),l.a.to(".scene2 .option2",{color:"#FFFFFF"})])},E=function(){A.current&&A.current.clear(),A.current=l.a.timeline({repeat:-1,paused:!0});var e=l.a.timeline();l.a.set("#circle1",{r:4,autoAlpha:0}),l.a.set(".svgCircle",{autoAlpha:0}),l.a.set("#mainCircle",{scale:1}),e.add(l.a.to(".scene2",{autoAlpha:0})),e.add([l.a.to(".scene3",{autoAlpha:1})]);var t=Array.from(document.querySelectorAll(".svgCircle")).reverse();e.add((function(){A.current.play()})),e.add([l.a.timeline().staggerTo(t,.6,{autoAlpha:1},.3)]),A.current.add([l.a.timeline().staggerFromTo(t,.6,{scale:1,autoRound:!1},{scale:1.1,autoRound:!1,ease:"power1.out"},.3),l.a.timeline().staggerFromTo(t,.6,{scale:1.1,autoRound:!1},{scale:1,autoRound:!1,delay:.6,ease:"power1.in"},.3)])},M=function(){A.current&&A.current.clear();var e=l.a.timeline();l.a.set("#circle1",{r:4,autoAlpha:0}),l.a.set("#circle1",{r:"Day"===k?3.5:4.2,autoAlpha:0}),l.a.to("#mainCircle",{scale:2}),e.add(l.a.to(".scene3",{autoAlpha:0})),e.add([l.a.fromTo(".scene4",{autoAlpha:0,color:"transparent"},{autoAlpha:1,color:"Day"===k?"#000000":"#FFFFFF"}),l.a.fromTo("#circleBackground",{r:0,fill:"Day"===k?"#FFFFFF":"#000000"},{autoRound:!1,r:2.5})])},R=function(){A.current&&A.current.clear();var e=l.a.timeline();e.add(l.a.to(".scene4",{autoAlpha:0})),e.add(l.a.to(".scene5",{autoAlpha:1})),l.a.set(".scene5 .centerText",{color:"Day"===k?"#000000":"#FFFFFF"}),e.add(l.a.fromTo(".scene5 .centerText",{text:{value:3},y:"-50%",scale:0,autoAlpha:0},{y:"-50%",scale:1,autoAlpha:1,duration:1})),e.add(l.a.fromTo(".scene5 .centerText",{text:{value:2},y:"-50%",scale:0,autoAlpha:0},{y:"-50%",scale:1,autoAlpha:1,duration:1})),e.add(l.a.fromTo(".scene5 .centerText",{text:{value:1},y:"-50%",scale:0,autoAlpha:0},{y:"-50%",scale:1,autoAlpha:1,duration:1}))},S=function(){var e=l.a.timeline();l.a.set(".scene6 .centerText",{color:"Day"===k?"#000000":"#FFFFFF"}),e.add(l.a.to(".scene5",{autoAlpha:0})),e.add(l.a.to(".scene6",{autoAlpha:1}))},G=function(){var e=l.a.timeline();e.add(l.a.to(".scene6",{autoAlpha:0})),e.add(l.a.to(".scene7",{autoAlpha:1})),l.a.set(".scene7 .centerText",{color:"Day"===k?"#000000":"#FFFFFF"}),e.add(l.a.fromTo(".scene7 .centerText",{text:{value:3},y:"-50%",scale:0,autoAlpha:0},{y:"-50%",scale:1,autoAlpha:1,duration:1})),e.add(l.a.fromTo(".scene7 .centerText",{text:{value:2},y:"-50%",scale:0,autoAlpha:0},{y:"-50%",scale:1,autoAlpha:1,duration:1})),e.add(l.a.fromTo(".scene7 .centerText",{text:{value:1},y:"-50%",scale:0,autoAlpha:0},{y:"-50%",scale:1,autoAlpha:1,duration:1}))},I=function(){var e=l.a.timeline();l.a.set(".scene8 .centerText",{color:"Day"===k?"#000000":"#FFFFFF"}),e.add(l.a.to(".scene7",{autoAlpha:0})),e.add(l.a.to(".scene8",{autoAlpha:1}))},C=function(){var e=l.a.timeline();e.add([l.a.to("#mainCircle",{scale:4,autoAlpha:0}),l.a.to(".scene8",{autoAlpha:0})]),e.add(l.a.to(".scene9",{autoAlpha:1}))},B=function(){w.current&&w.current.emit("shake");var e=l.a.timeline();l.a.set(".shakeEffect g",{stroke:"Day"===k?"#000000":"#FFFFFF"}),e.add(l.a.to(".mobileIcon",{rotate:10,ease:u.a.easeOut,duration:.1})),e.add([l.a.to(".shakeEffect",{autoAlpha:1,duration:.25}),l.a.to(".mobileIcon",{rotate:-15,duration:.25})]),e.add([l.a.to(".shakeEffect",{autoAlpha:0,duration:.15}),l.a.to(".mobileIcon",{rotate:0,ease:u.a.easeOut,duration:.15})])};return Object(s.useEffect)((function(){T(),document.addEventListener("click",(function(e){}))}),[]),Object(s.useEffect)((function(){d&&(w.current=Object(j.a)({host:"10.0.1.40:3003",eventEmitters:[{emitter:"joinRoom",data:{playerId:e},ack:function(e){console.log("joinRoomAck",e),"joined"!==e.data&&(O(e.data),function(){var e=l.a.timeline();e.add(l.a.to(".scene",{autoAlpha:0})),e.add(l.a.to(".sceneError",{autoAlpha:1}))}())}}],eventListeners:[{listener:"gameStage",callback:function(e){switch(console.log("gameStage",e),e.data){case 0:T();break;case 1:D();break;case 2:P();break;case 3:E();break;case 4:M();break;case 5:R();break;case 6:S();break;case 7:G();break;case 8:I();break;case 9:C()}}},{listener:"gameResult",callback:function(e){console.log("gameResult",e)}},{listener:"playersInfo",callback:function(e){console.log("playersInfo",e)}},{listener:"OnPlayerSelectMode",callback:function(e){console.log("OnPlayerSelectMode",e);var t=e.data;y(t)}},{listener:"gameSelected",callback:function(e){console.log("gameSelected",e)}}]}),D())}),[d]),Object(s.useEffect)((function(){B()}),[o]),Object(r.jsxs)("div",{id:"gameMain",children:[Object(r.jsx)("div",{className:"background",children:Object(r.jsx)("svg",{viewBox:"0 0 10 10",children:Object(r.jsxs)("g",{id:"mainCircle",children:[new Array(11).fill(0).map((function(e,t){return Object(r.jsx)("rect",{id:"circle".concat(t+2),className:"svgCircle",rx:"100",x:5-(27-2*t)/2,y:5-(27-2*t)/2,width:27-2*t,height:27-2*t,fill:t%2?"#000000":"#FFFFFF"},t)})),Object(r.jsx)("circle",{id:"circle1",cx:"5",cy:"5",r:"4",fill:"none",stroke:"#000000",strokeWidth:"1"}),Object(r.jsx)("circle",{id:"circleBackground",cx:"5",cy:"5",r:"0",fill:"none"})]})})}),Object(r.jsx)("div",{className:"reset",style:{position:"absolute",bottom:0,right:0,background:"#FFF",zIndex:99},onPointerDown:T,children:"reset"}),Object(r.jsx)("div",{className:"debug",style:{position:"absolute",top:0,left:0,background:"#FFF",zIndex:99},onPointerDown:function(){return b(0)},children:o}),Object(r.jsx)("div",{className:"scene scene0",children:Object(r.jsx)("div",{className:"joinGameButton",onPointerDown:function(){f()},children:"Join Game"})}),Object(r.jsx)("div",{className:"scene scene1",onPointerDown:P,children:Object(r.jsx)("div",{className:"centerText",children:"Wait for other players ..."})}),Object(r.jsxs)("div",{className:"scene scene2",children:[Object(r.jsx)("div",{className:"centerText",children:"Which look would you like to do?"}),Object(r.jsx)("div",{className:"option option1",onPointerDown:function(){N(0),E()},children:"Day"}),Object(r.jsx)("div",{className:"option option2",onPointerDown:function(){N(1),E()},children:"Night"})]}),Object(r.jsx)("div",{className:"scene scene3",onPointerDown:M,children:Object(r.jsx)("div",{className:"centerText",children:"Loading..."})}),Object(r.jsx)("div",{className:"scene scene4",onPointerDown:R,children:Object(r.jsxs)("div",{className:"centerText",children:[Object(r.jsx)("div",{className:"resultTitle",children:"The look we are doing is..."}),Object(r.jsxs)("div",{className:"resultText",children:[k,"!"]})]})}),Object(r.jsx)("div",{className:"scene scene5",onPointerDown:S,children:Object(r.jsx)("div",{className:"centerText"})}),Object(r.jsx)("div",{className:"scene scene6",children:Object(r.jsxs)("div",{className:"centerText",children:[Object(r.jsx)("svg",{viewBox:"0 0 35 23",className:"shakeEffect shakeEffect1",children:Object(r.jsxs)("g",{stroke:"#FFF",fill:"none",strokeWidth:"3",children:[Object(r.jsx)("path",{d:"M153.28 463.88l1.277-.34c7.393-1.973 14.995 2.385 17.029 9.762h0",transform:"translate(-141 -459) rotate(-177 162.433 466.64)"}),Object(r.jsx)("path",{d:"M142.736 467.692l2.32-.619c13.321-3.55 27.013 4.3 30.68 17.589h0",transform:"translate(-141 -459) rotate(-177 159.236 472.662)"})]})}),Object(r.jsx)("svg",{viewBox:"0 0 35 23",className:"shakeEffect shakeEffect2",children:Object(r.jsxs)("g",{stroke:"#FFF",fill:"none",strokeWidth:"3",children:[Object(r.jsx)("path",{d:"M153.28 463.88l1.277-.34c7.393-1.973 14.995 2.385 17.029 9.762h0",transform:"translate(-141 -459) rotate(-177 162.433 466.64)"}),Object(r.jsx)("path",{d:"M142.736 467.692l2.32-.619c13.321-3.55 27.013 4.3 30.68 17.589h0",transform:"translate(-141 -459) rotate(-177 159.236 472.662)"})]})}),Object(r.jsxs)("svg",{className:"mobileIcon",viewBox:"0 0 90 157",onPointerDown:B,children:[Object(r.jsx)("rect",{width:"90",height:"157",fill:"#FFF",rx:"2",stroke:"#000"}),Object(r.jsx)("rect",{width:"81",height:"121",x:"5",y:"14",fill:"#000",rx:"2"}),Object(r.jsx)("circle",{cx:"45",cy:"146",r:"6.5",stroke:"#000"})]}),Object(r.jsx)("div",{onPointerDown:G,children:"Shake!"})]})}),Object(r.jsx)("div",{className:"scene scene7",onPointerDown:I,children:Object(r.jsx)("div",{className:"centerText"})}),Object(r.jsx)("div",{className:"scene scene8",children:Object(r.jsxs)("div",{className:"centerText",children:[Object(r.jsx)("svg",{viewBox:"0 0 35 23",className:"shakeEffect shakeEffect1",children:Object(r.jsxs)("g",{stroke:"#FFF",fill:"none",strokeWidth:"3",children:[Object(r.jsx)("path",{d:"M153.28 463.88l1.277-.34c7.393-1.973 14.995 2.385 17.029 9.762h0",transform:"translate(-141 -459) rotate(-177 162.433 466.64)"}),Object(r.jsx)("path",{d:"M142.736 467.692l2.32-.619c13.321-3.55 27.013 4.3 30.68 17.589h0",transform:"translate(-141 -459) rotate(-177 159.236 472.662)"})]})}),Object(r.jsx)("svg",{viewBox:"0 0 35 23",className:"shakeEffect shakeEffect2",children:Object(r.jsxs)("g",{stroke:"#FFF",fill:"none",strokeWidth:"3",children:[Object(r.jsx)("path",{d:"M153.28 463.88l1.277-.34c7.393-1.973 14.995 2.385 17.029 9.762h0",transform:"translate(-141 -459) rotate(-177 162.433 466.64)"}),Object(r.jsx)("path",{d:"M142.736 467.692l2.32-.619c13.321-3.55 27.013 4.3 30.68 17.589h0",transform:"translate(-141 -459) rotate(-177 159.236 472.662)"})]})}),Object(r.jsxs)("svg",{className:"mobileIcon",viewBox:"0 0 90 157",onPointerDown:B,children:[Object(r.jsx)("rect",{width:"90",height:"157",fill:"#FFF",rx:"2",stroke:"#000"}),Object(r.jsx)("rect",{width:"81",height:"121",x:"5",y:"14",fill:"#000",rx:"2"}),Object(r.jsx)("circle",{cx:"45",cy:"146",r:"6.5",stroke:"#000"})]}),Object(r.jsx)("div",{onPointerDown:C,children:"Shake!"})]})}),Object(r.jsx)("div",{className:"scene scene9",children:Object(r.jsxs)("div",{className:"centerText",children:[Object(r.jsx)("img",{id:"logo",src:"./media/logo.svg",alt:"SEPHORA"}),Object(r.jsx)("div",{className:"coupon",children:Object(r.jsx)("img",{src:"./media/coupon.jpg",alt:"coupon"})}),Object(r.jsxs)("div",{className:"disclaimer",children:["Offer is valid once per member during Jan 6 - 31, 2021 at in Sephora Hong Kong K-11 Art Mall store. Offer is not valid with other discounts and promotion, gift cards, services, charitable items or any other exclusions mentioned in-store, on ",Object(r.jsx)("a",{href:"https://sephora.hk",target:"_blank",children:"sephora.hk"})," and/or and Sephora Hong Kong mobile app."]})]})}),Object(r.jsx)("div",{className:"scene sceneError",children:Object(r.jsx)("div",{className:"centerText",children:p})})]})}},35:function(e,t,a){},43:function(e,t,a){"use strict";var c=a(50),n=a.n(c);t.a=function(e){var t=e.host,a=e.eventListeners,c=e.eventEmitters,o=n()(t,{secure:!1});return o.on("connect",(function(){console.log("connected !"),c.forEach((function(e){var t="function"===typeof e.ack?e.ack:null;o.emit(e.emitter,e.data,t)}))})),a.forEach((function(e){o.on(e.listener,e.callback)})),o}},59:function(e,t){}}]);
//# sourceMappingURL=2.2e0762ce.chunk.js.map