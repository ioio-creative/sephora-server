(this["webpackJsonpsephora-shakeshakegame"]=this["webpackJsonpsephora-shakeshakegame"]||[]).push([[2,8],{20:function(e,t,a){"use strict";a.r(t);var c=a(64),n=a(3),r=a(0),s=a(1),o=a(92),i=a(94),l=a(36),d={serverUrl:"sephora.ioiocreative.com:3000"},u=function(){var e=Object(r.useState)(!1),t=Object(c.a)(e,2),a=t[0],n=t[1],s=Object(r.useState)(0),o=Object(c.a)(s,2),i=o[0],l=o[1];Object(r.useEffect)((function(){return a&&window.addEventListener("devicemotion",h,!1),function(){window.removeEventListener("devicemotion",h,!1)}}),[a]);var d=[null,null,null],u=Object(r.useRef)(0),h=function(e){var t=0,a=0,c=0;e.acceleration?(t=e.acceleration.x,a=e.acceleration.y,c=e.acceleration.z):(t=e.accelerationIncludingGravity.x,a=e.accelerationIncludingGravity.y,c=e.accelerationIncludingGravity.z);var n=Date.now(),r=n-u.current,s=(Math.abs(t-d[0]),Math.abs(a-d[1]));Math.abs(c-d[2]);Math.sign(d[1])!==Math.sign(a)&&(u.current=n,d=[t,a,c]),s/r>.5&&l((function(e){return e+1}))};return[{moveCounter:i,permissionGranted:a},{requestPermission:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Please allow the Device Motion to start the game.\n\u8acb\u5141\u8a31\u4f7f\u7528\u88dd\u7f6e\u52a0\u901f\u8a08\u6b0a\u9650\u4ee5\u9032\u884c\u904a\u6232";"function"===typeof DeviceMotionEvent&&"function"===typeof DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then((function(t){"granted"==t?n(!0):alert(e)})).catch(alert):n(!0)},setPermissionGranted:n,setMoveCounter:l}]},h=a(43);a(35);o.a.registerPlugin(i.a);var j=["Day","Night"];t.default=function(){var e=Object(s.g)().playerId,t=u(),a=Object(c.a)(t,2),i=a[0],m=i.moveCounter,f=i.permissionGranted,b=a[1],v=b.requestPermission,x=(b.setMoveCounter,Object(r.useState)("")),p=Object(c.a)(x,2),O=p[0],g=p[1],k=Object(r.useState)(""),A=Object(c.a)(k,2),F=A[0],y=A[1];console.log("playerId: ",e);var N=Object(r.useRef)(null),w=Object(r.useRef)(null),T=function(e){w.current&&w.current.emit("selectGame",{data:e})},E=function(){N.current&&N.current.clear(),N.current=o.a.timeline({repeat:-1,repeatDelay:3}),o.a.set("#mainCircle",{scale:1,autoAlpha:1,transformOrigin:"center"}),o.a.set(".svgCircle",{scaleX:2,scaleY:1,rx:0,transformOrigin:"center"}),o.a.set("#circle1",{autoAlpha:0,r:4}),o.a.set(".scene",{autoAlpha:0}),o.a.set(".scene.scene0",{autoAlpha:1}),o.a.set("#circle1",{r:4}),o.a.set("#circleBackground",{r:0,fill:"none"}),N.current.add(o.a.to(".scene0 .joinGameButton",{rotate:-5,duration:.1,ease:"elastic.out(1, 0.75)"})),N.current.add(o.a.to(".scene0 .joinGameButton",{rotate:0,duration:1,ease:"elastic.out(2, 0.2)"}))},M=function(){N.current&&N.current.clear(),N.current=o.a.timeline({repeat:-1,paused:!0});var e=Array.from(document.querySelectorAll(".svgCircle")).reverse(),t=o.a.timeline();t.add([o.a.to(e,{scaleX:1,scaleY:1,rx:100,autoRound:!1,duration:.5}),o.a.to(".scene.scene0",{autoAlpha:0})]),t.add([o.a.set("#circle1",{autoAlpha:0}),o.a.set(".scene.scene1",{autoAlpha:1})]),t.add((function(){N.current.play()})),N.current.add([o.a.timeline().staggerFromTo(e,.6,{scale:1,autoRound:!1},{scale:1.1,autoRound:!1,ease:"power1.out"},.3),o.a.timeline().staggerFromTo(e,.6,{scale:1.1,autoRound:!1},{scale:1,autoRound:!1,delay:.6,ease:"power1.in"},.3)])},R=function(){N.current&&N.current.clear(),N.current=o.a.timeline({repeat:-1,paused:!0});var e=o.a.timeline();o.a.set("#circle1",{r:4,autoAlpha:0}),o.a.set(".svgCircle",{autoAlpha:0}),o.a.set("#mainCircle",{scale:1}),e.add(o.a.to(".scene2",{autoAlpha:0})),e.add([o.a.to(".scene3",{autoAlpha:1})]);var t=Array.from(document.querySelectorAll(".svgCircle")).reverse();e.add((function(){N.current.play()})),e.add([o.a.timeline().staggerTo(t,.6,{autoAlpha:1},.3)]),N.current.add([o.a.timeline().staggerFromTo(t,.6,{scale:1,autoRound:!1},{scale:1.1,autoRound:!1,ease:"power1.out"},.3),o.a.timeline().staggerFromTo(t,.6,{scale:1.1,autoRound:!1},{scale:1,autoRound:!1,delay:.6,ease:"power1.in"},.3)])};return Object(r.useEffect)((function(){E(),document.addEventListener("click",(function(e){}))}),[]),Object(r.useEffect)((function(){f&&(w.current=Object(h.a)({host:d.serverUrl,eventEmitters:[{emitter:"joinRoom",data:{playerId:e||"empty"},ack:function(e){console.log("joinRoomAck",e),"joined"!==e.data&&(g(e.data),function(){var e=o.a.timeline();e.add(o.a.to(".scene",{autoAlpha:0})),e.add(o.a.to(".sceneError",{autoAlpha:1})),w.current&&w.current.disconnect()}())}}],eventListeners:[{listener:"gameStage",callback:function(e){switch(console.log("gameStage",e),e.data){case 0:E();break;case 1:M();break;case 2:!function(){N.current&&N.current.clear();var e=o.a.timeline();e.add([o.a.set(".scene2 .option",{scale:0,color:"transparent"})]),e.add(o.a.to("#mainCircle",{scale:4,transformOrigin:"center",duration:.5})),e.add(o.a.to(".scene1",{autoAlpha:0})),e.add(o.a.to(".scene2",{autoAlpha:1})),e.add([o.a.to(".scene2 .option1",{scale:1}),o.a.to(".scene2 .option2",{scale:1})]),e.add([o.a.to(".scene2 .option1",{color:"#000000"}),o.a.to(".scene2 .option2",{color:"#FFFFFF"})])}();break;case 3:R();break;case 4:!function(){N.current&&N.current.clear();var e=o.a.timeline();o.a.set("#circle1",{r:4,autoAlpha:0}),o.a.set("#circle1",{r:3.5,autoAlpha:0}),o.a.set(".scene4 .resultText",{autoAlpha:0}),o.a.to("#mainCircle",{scale:2}),e.add([o.a.to(".scene2",{autoAlpha:0}),o.a.to(".scene3",{autoAlpha:0})]),e.add([o.a.fromTo(".scene4",{autoAlpha:0,color:"transparent"},{autoAlpha:1,color:"#000000"}),o.a.fromTo("#circleBackground",{r:0,fill:"#FFFFFF"},{autoRound:!1,r:2.5})]),e.add([o.a.to(".scene4 .resultText",{autoAlpha:1,delay:2.6})])}();break;case 5:!function(){N.current&&N.current.clear();var e=o.a.timeline();e.add(o.a.to(".scene4",{autoAlpha:0,duration:.5})),o.a.set(".scene5 .centerText",{text:{value:3},color:"#000000"}),e.add(o.a.to(".scene5",{autoAlpha:1,duration:.5})),e.add(o.a.fromTo(".scene5 .centerText",{text:{value:2},scale:0,autoAlpha:0},{scale:1,autoAlpha:1,duration:1})),e.add(o.a.fromTo(".scene5 .centerText",{text:{value:1},scale:0,autoAlpha:0},{scale:1,autoAlpha:1,duration:1}))}();break;case 6:!function(){var e=o.a.timeline();o.a.set(".scene6 .centerText",{color:"#000000"}),e.add(o.a.to(".scene5",{autoAlpha:0,duration:.4})),e.add(o.a.to(".scene6",{autoAlpha:1,duration:.4}))}();break;case 7:!function(){var e=o.a.timeline();e.add(o.a.to(".scene6",{autoAlpha:0,duration:.4})),e.add(o.a.to(".scene7",{autoAlpha:1,duration:.4})),o.a.set(".scene7 .centerText",{color:"#000000"})}();break;case 8:break;case 9:!function(){var e=o.a.timeline();o.a.set(".scene8 .centerText",{color:"#000000"}),e.add(o.a.to(".scene7",{autoAlpha:0,duration:.4})),e.add(o.a.to(".scene8",{autoAlpha:1,duration:.4}))}();break;case 10:!function(){var e=o.a.timeline();e.add([o.a.to("#mainCircle",{scale:4,autoAlpha:0}),o.a.to(".scene8",{autoAlpha:0,duration:.4})]),e.add(o.a.to(".scene9",{autoAlpha:1,duration:.4})),w.current&&w.current.disconnect()}()}}},{listener:"gameResult",callback:function(e){console.log("gameResult",e)}},{listener:"playersInfo",callback:function(e){console.log("playersInfo",e)}},{listener:"OnPlayerSelectMode",callback:function(e){console.log("OnPlayerSelectMode",e);var t=e.data;y(j[t])}},{listener:"gameSelected",callback:function(e){console.log("gameSelected",e)}}]}),M())}),[f]),Object(r.useEffect)((function(){!function(){w.current&&w.current.emit("shake");var e=o.a.timeline();o.a.set(".shakeEffect g",{stroke:"#000000"}),e.add(o.a.to(".mobileIcon",{rotate:10,ease:l.a.easeOut,duration:.1})),e.add([o.a.to(".shakeEffect",{autoAlpha:1,duration:.25}),o.a.to(".mobileIcon",{rotate:-15,duration:.25})]),e.add([o.a.to(".shakeEffect",{autoAlpha:0,duration:.15}),o.a.to(".mobileIcon",{rotate:0,ease:l.a.easeOut,duration:.15})])}()}),[m]),Object(n.jsxs)("div",{id:"gameMain",children:[Object(n.jsx)("div",{className:"background",children:Object(n.jsx)("svg",{viewBox:"0 0 10 10",children:Object(n.jsxs)("g",{id:"mainCircle",children:[new Array(11).fill(0).map((function(e,t){return Object(n.jsx)("rect",{id:"circle".concat(t+2),className:"svgCircle",rx:"100",x:5-(27-2*t)/2,y:5-(27-2*t)/2,width:27-2*t,height:27-2*t,fill:t%2?"#000000":"#FFFFFF"},t)})),Object(n.jsx)("circle",{id:"circle1",cx:"5",cy:"5",r:"4",fill:"none",stroke:"#000000",strokeWidth:"1"}),Object(n.jsx)("circle",{id:"circleBackground",cx:"5",cy:"5",r:"0",fill:"none"})]})})}),Object(n.jsx)("div",{className:"scene scene0",children:Object(n.jsx)("div",{className:"joinGameButton",onClick:v,children:"Join Game"})}),Object(n.jsx)("div",{className:"scene scene1",children:Object(n.jsx)("div",{className:"centerText",children:"Wait for other players ..."})}),Object(n.jsxs)("div",{className:"scene scene2",children:[Object(n.jsx)("div",{className:"centerText",children:"Which look would you like to do?"}),Object(n.jsx)("div",{className:"option option1",onPointerDown:function(){T(0),R()},children:"Day"}),Object(n.jsx)("div",{className:"option option2",onPointerDown:function(){T(1),R()},children:"Night"})]}),Object(n.jsx)("div",{className:"scene scene3",children:Object(n.jsx)("div",{className:"centerText",children:"Loading..."})}),Object(n.jsx)("div",{className:"scene scene4",children:Object(n.jsxs)("div",{className:"centerText",children:[Object(n.jsx)("div",{className:"resultTitle",children:"The look we are doing is..."}),Object(n.jsxs)("div",{className:"resultText",children:[F,"!"]})]})}),Object(n.jsx)("div",{className:"scene scene5",children:Object(n.jsx)("div",{className:"centerText"})}),Object(n.jsx)("div",{className:"scene scene6",children:Object(n.jsxs)("div",{className:"centerText",children:[Object(n.jsx)("svg",{viewBox:"0 0 35 23",className:"shakeEffect shakeEffect1",children:Object(n.jsxs)("g",{stroke:"#FFF",fill:"none",strokeWidth:"3",children:[Object(n.jsx)("path",{d:"M153.28 463.88l1.277-.34c7.393-1.973 14.995 2.385 17.029 9.762h0",transform:"translate(-141 -459) rotate(-177 162.433 466.64)"}),Object(n.jsx)("path",{d:"M142.736 467.692l2.32-.619c13.321-3.55 27.013 4.3 30.68 17.589h0",transform:"translate(-141 -459) rotate(-177 159.236 472.662)"})]})}),Object(n.jsx)("svg",{viewBox:"0 0 35 23",className:"shakeEffect shakeEffect2",children:Object(n.jsxs)("g",{stroke:"#FFF",fill:"none",strokeWidth:"3",children:[Object(n.jsx)("path",{d:"M153.28 463.88l1.277-.34c7.393-1.973 14.995 2.385 17.029 9.762h0",transform:"translate(-141 -459) rotate(-177 162.433 466.64)"}),Object(n.jsx)("path",{d:"M142.736 467.692l2.32-.619c13.321-3.55 27.013 4.3 30.68 17.589h0",transform:"translate(-141 -459) rotate(-177 159.236 472.662)"})]})}),Object(n.jsxs)("svg",{className:"mobileIcon",viewBox:"0 0 90 157",children:[Object(n.jsx)("rect",{width:"90",height:"157",fill:"#FFF",rx:"2",stroke:"#000"}),Object(n.jsx)("rect",{width:"81",height:"121",x:"5",y:"14",fill:"#000",rx:"2"}),Object(n.jsx)("circle",{cx:"45",cy:"146",r:"6.5",stroke:"#000"})]}),Object(n.jsx)("div",{children:"Shake!"})]})}),Object(n.jsx)("div",{className:"scene scene7",children:Object(n.jsx)("div",{className:"centerText",children:"Waiting..."})}),Object(n.jsx)("div",{className:"scene scene8",children:Object(n.jsxs)("div",{className:"centerText",children:[Object(n.jsx)("svg",{viewBox:"0 0 35 23",className:"shakeEffect shakeEffect1",children:Object(n.jsxs)("g",{stroke:"#FFF",fill:"none",strokeWidth:"3",children:[Object(n.jsx)("path",{d:"M153.28 463.88l1.277-.34c7.393-1.973 14.995 2.385 17.029 9.762h0",transform:"translate(-141 -459) rotate(-177 162.433 466.64)"}),Object(n.jsx)("path",{d:"M142.736 467.692l2.32-.619c13.321-3.55 27.013 4.3 30.68 17.589h0",transform:"translate(-141 -459) rotate(-177 159.236 472.662)"})]})}),Object(n.jsx)("svg",{viewBox:"0 0 35 23",className:"shakeEffect shakeEffect2",children:Object(n.jsxs)("g",{stroke:"#FFF",fill:"none",strokeWidth:"3",children:[Object(n.jsx)("path",{d:"M153.28 463.88l1.277-.34c7.393-1.973 14.995 2.385 17.029 9.762h0",transform:"translate(-141 -459) rotate(-177 162.433 466.64)"}),Object(n.jsx)("path",{d:"M142.736 467.692l2.32-.619c13.321-3.55 27.013 4.3 30.68 17.589h0",transform:"translate(-141 -459) rotate(-177 159.236 472.662)"})]})}),Object(n.jsxs)("svg",{className:"mobileIcon",viewBox:"0 0 90 157",children:[Object(n.jsx)("rect",{width:"90",height:"157",fill:"#FFF",rx:"2",stroke:"#000"}),Object(n.jsx)("rect",{width:"81",height:"121",x:"5",y:"14",fill:"#000",rx:"2"}),Object(n.jsx)("circle",{cx:"45",cy:"146",r:"6.5",stroke:"#000"})]}),Object(n.jsx)("div",{children:"Shake!"})]})}),Object(n.jsx)("div",{className:"scene scene9",children:Object(n.jsxs)("div",{className:"centerText",children:[Object(n.jsx)("img",{id:"logo",src:"./media/logo.svg",alt:"SEPHORA"}),Object(n.jsx)("div",{className:"coupon",children:Object(n.jsx)("img",{src:"./media/coupon.jpg",alt:"coupon"})}),Object(n.jsxs)("div",{className:"disclaimer",children:["Offer is valid once per member during Jan 6 - 31, 2021 at in Sephora Hong Kong K-11 Art Mall store. Offer is not valid with other discounts and promotion, gift cards, services, charitable items or any other exclusions mentioned in-store, on ",Object(n.jsx)("a",{href:"https://sephora.hk",target:"_blank",children:"sephora.hk"})," and/or and Sephora Hong Kong mobile app."]})]})}),Object(n.jsx)("div",{className:"scene sceneError",children:Object(n.jsx)("div",{className:"centerText",children:O})})]})}},35:function(e,t,a){},43:function(e,t,a){"use strict";var c=a(50),n=a.n(c);t.a=function(e){var t=e.host,a=e.eventListeners,c=e.eventEmitters,r=n()(t,{secure:!1});return r.on("connect",(function(){console.log("connected !"),c.forEach((function(e){var t="function"===typeof e.ack?e.ack:null;r.emit(e.emitter,e.data,t)}))})),a.forEach((function(e){r.on(e.listener,e.callback)})),r}},59:function(e,t){}}]);
//# sourceMappingURL=2.d61ffadb.chunk.js.map